<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js"></script>

    <title>ROS Drone Web Demo </title>

    <script>

        var ros = new ROSLIB.Ros();
            // Create a connection to the rosbridge WebSocket server.
        ros.connect('ws://localhost:9090');
        

        // Drone state subscription
        var DroneState = new ROSLIB.Topic({
            ros: ros,
            name: "/mavros/state",
            messageType: "mavros_msgs/State" 
        });
      
        DroneState.subscribe(function(msg){
            var ArmingState;
            if(msg.armed){
                ArmingState = "Drone Armed";
            }
            else{
                ArmingState = "Drone Disarmed";

            }
            var DroneMode = msg.mode;

            console.log(ArmingState);
            console.log(DroneMode);

            document.getElementById("Drone Arming State").innerHTML = '<span style="font-weight: bold;">Drone arm state: </span>'+ ArmingState;
            document.getElementById("Drone Mode").innerHTML = '<span style="font-weight: bold;">Drone mode: </span>'+ DroneMode;


        });

        // creating a client request to arm drone 
        function armDrone() {
            var armService = new ROSLIB.Service({
                ros: ros,
                name: '/mavros/cmd/arming',
                serviceType: 'mavros_msgs/CommandBool'
            });

            var request = new ROSLIB.ServiceRequest({
                value: true // Set to true to arm the drone
            });

            armService.callService(request, function (result) {
                console.log('Drone arming request sent:', result);
            });
        }

        



    </script>


</head>



<body>
    
    <h1>ROS Drone Web Demo </h1>
    <p> A simple entry point for ROS1 to web integration for drone</p>

    <div id="Drone Arming State" >Drone Arming State: </div>
    <div id="Drone Mode">Drone Mode: </div>

    <button onclick="armDrone()" style="font-weight: bold;">ArmDrone</button>



</body>




</html>